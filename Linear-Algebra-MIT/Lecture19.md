# [Lecture 19: Determinant formulas and cofactors](https://ocw.mit.edu/courses/18-06-linear-algebra-spring-2010/resources/lecture-19-determinant-formulas-and-cofactors/)

## **二阶行列式公式**

上一讲我们提到二阶行列式：$\begin{vmatrix} 
a & b \\
c & d
\end{vmatrix} = ad-bc$

它可以根据行列式的性质来得到：$\begin{vmatrix} 
a & b \\
c & d
\end{vmatrix} = 
\begin{vmatrix}
a & 0 \\
c & d
\end{vmatrix} +
\begin{vmatrix}
0 & b \\
c & d
\end{vmatrix}= \begin{vmatrix}
a & 0 \\
c & 0
\end{vmatrix} +
\begin{vmatrix}
a & 0 \\
0 & d
\end{vmatrix} +
\begin{vmatrix}
0 & b \\
c & 0
\end{vmatrix} +
\begin{vmatrix}
0 & b \\
0 & d
\end{vmatrix}$

根据性质3分解出2×2个行列式，其中第一项和第四项由于存在全零列，故值为0。第二项根据性质7可知值为ad，第三项根据性质2和7可知值为−bc，因此得证：$\begin{vmatrix}
a & b \\
c & d
\end{vmatrix} = ad-bc$

## **从二阶到三阶**

采用同样的手法，我们也可以拆分三阶行列式：先保持2、3行不变，对第1行进行拆分，得到3个行列式，再对这3个行列式的第2行进行拆分，共得到3×3个行列式，再接着拆分这9个行列式的第3行，最终得到3×3×3个行列式，我们忽略存在全零列的行列式，最终得到6个行列式加和：

$$
\begin{vmatrix} 
a_{11} & a_{12} & a_{13} \\
a_{21} & a_{22} & a_{23} \\
a_{31} & a_{32} & a_{33}
\end{vmatrix} = 
\begin{vmatrix}
a_{11} & 0 & 0 \\
0 & a_{22} & 0 \\
0 & 0 & a_{33}
\end{vmatrix} +
\begin{vmatrix}
a_{11} & 0 & 0 \\
0 & 0 & a_{23} \\
0 & a_{32} & 0
\end{vmatrix} +
\begin{vmatrix}
0 & a_{12} & 0 \\
a_{21} & 0 & 0 \\
0 & 0 & a_{33}
\end{vmatrix} +
\begin{vmatrix}
0 & a_{12} & 0 \\
0 & 0 & a_{23} \\
a_{31} & 0 & 0
\end{vmatrix} +
\begin{vmatrix}
0 & 0 & a_{13} \\
a_{21} & 0 & 0 \\
0 & a_{32} & 0
\end{vmatrix} +
\begin{vmatrix}
0 & 0 & a_{13} \\
0 & a_{22} & 0 \\
a_{31} & 0 & 0
\end{vmatrix}
$$

行列式 = 

$$
a_{11}a_{22}a_{33} - a_{11}a_{23}a_{32} - a_{12}a_{21}a_{33} + a_{12}a_{23}a_{31} + a_{13}a_{21}a_{32} - a_{13}a_{22}a_{31}
$$

根据排列组合思想，可以得出n阶行列式分解可以得到n!个非零行列式，故一般公式可以写作：

$$
\det A = \sum_{n!} \pm a_{1\sigma_1}a_{2\sigma_2}a_{3\sigma_3}...a_{n\sigma_n}, (\sigma_1,\sigma_2,\sigma_3,...,\sigma_n)=P_n^n
$$

**前面的正负号，要取决于行列式转为三角阵所需行交换的步数，若步数为偶数，那么符号为正；若步数为奇数，则符号为负。**

有一个比较优雅的算法来判断非零行列式的符号：统计数列的逆序数，逆序数就是从左到右遍历当前排列中的每一个数，统计它的右侧有几个数比自己小，最终加和求得。比如对于排列(4,3,2,1)来说，它的逆序数就是3+2+1=6，逆序数为偶数故为偶排列，否则就是奇排列。偶排列符号取正，奇排列符号取负。

## **代数余子式**

将三阶行列式的一般公式做一下合并同类项：

$$
a_{11}(a_{22}a_{33}-a_{23}a_{32})+a_{12}(-a_{21}a_{33}+a_{23}a_{32})+a_{13}(a_{21}a_{32}-a_{22}a_{31})
$$

合并后，我们发现上式可以看成：

$$
\begin{vmatrix} 
a_{11} & 0 & 0 \\
0 & a_{22} & a_{23} \\
0 & a_{32} & a_{33}
\end{vmatrix} +
\begin{vmatrix}
0 & a_{12} & 0 \\
a_{21} & 0 & a_{23} \\
a_{31} & 0 & a_{33}
\end{vmatrix} +
\begin{vmatrix}
0 & 0 & a_{13} \\
a_{21} & a_{22} & 0 \\
a_{31} & a_{32} & 0
\end{vmatrix}
$$

也就是：

$$
a_{11}\begin{vmatrix}a_{22} & a_{23} \\ a_{32} & a_{33}\end{vmatrix} + a_{12}(-\begin{vmatrix}a_{21} & a_{23} \\ a_{31} & a_{33}\end{vmatrix}) + a_{13}\begin{vmatrix}a_{21} & a_{22} \\ a_{31} & a_{32}\end{vmatrix}
$$

这就表明，3阶行列式由多个2阶行列式组成。由此递推，n阶行列式就是由多个 n-1 阶行列式组成。由此，我们就找出了自顶向下的递归关系。

实际上，括号里的部分我们称作**代数余子式**，比如 $(a_{22}a_{33}-a_{23}a_{32})$ 就是 $a_{11}$ 的代数余子式。对于选定元素 $a_{ij}$，其代数余子式为：将原行列式的第 i 行与第 j 列元素全部抹去，剩余的 n-1 阶行列式再取正负，得到的算式就是代数余子式，一般记为 $A_{ij}$。那么这个正负要怎么判断呢？可以根据$i,j$ 来判定：

$$
A_{ij}=(-1)^{i+j}\cdot\det(\text{去掉}i\text{行}j\text{列的}n-1\text{阶方阵})
$$

使用代数余子式可以将一般计算公式简写作：

$$
\det A = a_{11}A_{11}+a_{12}A_{12}+...+a_{1n}A_{1n}
$$

> 代数余子式的计算方式相比于借助行列式的特性、消元成三角阵求主元乘积的方法来说其实更麻烦一些。但是这里之所以探索一般公式，主要是为了挖掘n阶行列式与n-1阶行列式之间的关系，由此而递归下去。
> 

### **有趣的示例**

现有:

$$
D_1=1, D_2=\begin{vmatrix}1 & 1\\ 1 & 1\end{vmatrix}, D_3=\begin{vmatrix}1 & 1 & 0\\ 1 & 1 & 1\\ 0 & 1 & 1\end{vmatrix}, D_4=\begin{vmatrix}1 & 1 & 0 & 0\\ 1 & 1 & 1 & 0\\ 0 & 1 & 1 & 1\\ 0 & 0 & 1 & 1\end{vmatrix}
$$

寻找行列式之间的规律。容易求得 $D_1=1, D_2=0, D_3=-1$ 。我们可以发现 $D_4$ 的方阵按第一行展开，由于只有和$a_{11}$ 和 $a_{12}$ 非零，故拆分成代数余子式的形式有：

$$
D_4=1\cdot\begin{vmatrix}1 & 1 & 0\\ 0 & 1 & 1\\ 0 & 1 & 1\end{vmatrix}+(-1)\cdot\begin{vmatrix}1 & 1 & 0\\ 0 & 1 & 1\\ 0 & 1 & 1\end{vmatrix}
$$

其中第二项我们发现第一列只有1个元素非零，也就是说如果继续拆分到 $D_2$ 的组合，非零项只有1个，故上式相当于：

$$
D_4=D_3-D_2
$$

因此求得 $D_4=-1$。

> 实际上，这个矩阵十分特殊，它存在着这样的规律：$D_n=D_{n-1}-D_{n-2}$ ，行列式对应的值是一个数列：$1,0,-1,-1,0,1$，以6为周期。
>
# [Lecture 24: Markov matrices; fourier series](https://ocw.mit.edu/courses/18-06-linear-algebra-spring-2010/resources/lecture-24-markov-matrices-fourier-series/)

## **马尔科夫矩阵**

马尔科夫矩阵是一种描述概率相关的矩阵，它满足以下两条性质的矩阵：

1. 每个元素均为非负数；
2. 每列元素之和等于1；

形如：$A = \begin{bmatrix} 0.1 & 0.01 & 0.3 \\0.2 & 0.99 & 0.3 \\0.7 & 0 & 0.4\end{bmatrix}$

根据马尔科夫矩阵的性质，我们很容易得到两个推论：

1. 马尔科夫矩阵必有一个特征值 $λ₁ = 1$
2. 除了特征值以外，其他特征值的绝对值皆小于 $1$

推论一是显而易见的，因为马尔科夫矩阵的每个列和都是1，因此，对于 $A−I$ 来说，每个列和就都是0，此时显然 $A−I$ 的行向量线性相关，即为奇异矩阵，行列式为0。

推论二的证明课上没有给出，我们暂用这一结论。

考虑此前差分方程的算式：$u_k = A^ku_0 = c_1λ_1^kx_1 + c_2λ_2^kx_2 + ... + c_nλ_n^kx_n$，当A为马尔科夫矩阵时，由于 $λ_1 = 1$, $|λ_i| < 1$，因此当k趋于∞时，$u_k$ 趋于稳态：$c_1x_1$。

### **马尔科夫矩阵的应用**

课上用二阶马尔科夫矩阵模拟了两地人口迁移的模型：$\begin{bmatrix}U_{ka} \\ U_{ma}\end{bmatrix}_{t=k+1} = \begin{bmatrix} 0.9 & 0.2 \\ 0.1 & 0.8 \end{bmatrix} \begin{bmatrix}U_{ka} \\ U_{ma}\end{bmatrix}_{t=k}$

马尔科夫矩阵A可以解释为：每隔一个时间周期，会有90%的人口留在加州，10%的人口迁移到麻省；与此同时，会有80%的人口留在麻省，20%的人口迁移到加州。

假设初始状态：$U_{t=0} = \begin{bmatrix} 0 \\ 1000 \end{bmatrix}$。对于这一模型，我们来分析一下稳态：计算求得马尔科夫矩阵的特征值为1和0.7，对应特征向量为：$\begin{bmatrix} 2 \\ 1 \end{bmatrix}$, $\begin{bmatrix} -1 \\ 1 \end{bmatrix}$。

因此，通解为：$U_t = c_1\begin{bmatrix} 2 \\ 1 \end{bmatrix} + c_2(0.7)^t\begin{bmatrix} -1 \\ 1 \end{bmatrix}$。当t趋于无穷时，第二项可以忽略，即最终稳态由第一项$c_1\begin{bmatrix} 2 \\ 1 \end{bmatrix}$决定。

我们可以带入$U_0$来求得$c_1$和$c_2$分别为$\frac{1000}{3}$和$\frac{2000}{3}$，因此最终的稳态是：$\begin{bmatrix} \frac{2000}{3} \\ \frac{1000}{3} \end{bmatrix}$。即，经过无穷多次人口迁移后，加州的人口趋近于$\frac{2000}{3}$，麻省的人口趋近于$\frac{1000}{3}$。

## **傅里叶级数**

取n维空间一组标准正交基：$q_1,q_2,...,q_n$，它们可以表示空间中的任意向量: $v=x_1q_1+x_2q_2+...+x_nq_n$

即$Qx=v$，$x=Q^{-1}v$。由于正交矩阵 $Q^T=Q^{-1}$，故 $x=Q^Tv$。

对应到x的各个分量有：$x_i=q_i^Tv$。

由此可见：用空间的一组标准正交基去点乘目标向量，就可以得到各个分量。

傅里叶级数就是在标准正交基的基础上构建的，我们可以对任意函数做傅里叶展开，得到表达式：$f(x)=a_0+a_1\cos x+b_1\sin x+a_2\cos 2x+b_2\sin 2x+...$

傅里叶级数的展开最终是无限维，它的一组基是:$1,\cos x,\sin x,\cos 2x,\sin 2x...$。

傅里叶级数能够这样展开，恰恰源于这些基之间两两正交。

然而，此前我们对于向量的理解，首先它们是离散的，向量的内积可以写成:$v\cdot w=v_1w_1+...+v_nw_n$。然而，傅里叶级数里的基却并非向量，而是一个连续的函数，那么对于连续的函数来说，内积是什么呢？

**答案就是对二者的乘法进行积分。**

此外，我们观察到，这些基函数都有周期为2π的特性，所以我们只需要对$[0,2π]$区间进行积分即可：$\int_0^{2\pi}f(x)g(x)dx$

我们任取一个$g(x)$比如$\cos x$来进行计算：$\int_0^{2\pi}(a_0+a_1\cos x+b_1\sin x+a_2\cos 2x+b_2\sin 2x)\cos x dx=0+\int_0^{2\pi}a_1\cos^2 x dx+0+...+0$

可以发现，除了原本在无限维空间中方向一致的 $\cos x$ 以外，其他项的积分结果都是0，因此，$\cos x$和其他基向量正交。同理，也可以证的其他函数$g(x)$均有此性质。

另一方面，经过积分求解，还可以求得每一个系数$a_i$的表达式。例如：$a_1=\frac{1}{\pi}\int_0^{2\pi}f(x)\cos x dx$。同理可以求得其他系数。

> 所以从线性代数的角度来理解傅里叶级数，它本质上就是一种把函数展开到一组标准正交基上的手法。
>